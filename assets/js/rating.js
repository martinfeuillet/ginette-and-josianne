(function ($) {
    $(document).ready(function () {
        function fillStar(){
            $('.jet-listing-grid .avis__star-wrapper').each(function(){
                let rating = $(this).find('.review-count').text();
                if(rating){

                    // Afficher les étoiles entières
                    let fullStars = Math.floor(rating);
                    for (let i = 0; i < fullStars; i++) {
                        $(this).find('.star-wrapper:eq(' + i + ')').addClass('active').append('<svg width="26" height="25" viewBox="0 0 26 25" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12.8844 0C13.3336 0 13.7437 0.253887 13.939 0.65913L17.2883 7.55802L24.7682 8.66146C25.2077 8.72493 25.5738 9.03252 25.7105 9.45729C25.8473 9.88207 25.735 10.341 25.4225 10.6535L19.9981 16.0339L21.2773 23.631C21.3505 24.0704 21.1699 24.5148 20.8037 24.7784C20.4375 25.0421 19.959 25.0714 19.5684 24.8614L12.8795 21.2875L6.20031 24.8565C5.80483 25.0665 5.32635 25.0372 4.96505 24.7735C4.60375 24.5099 4.41821 24.0656 4.49145 23.6261L5.77065 16.0291L0.346255 10.6535C0.0288961 10.341 -0.0785177 9.87718 0.0581908 9.45729C0.194899 9.0374 0.561082 8.72981 1.0005 8.66146L8.48041 7.55802L11.8298 0.65913C12.0299 0.253887 12.4352 0 12.8844 0ZM12.8844 3.85713L10.3211 9.13994C10.1502 9.48659 9.82308 9.73071 9.43737 9.7893L3.66143 10.6388L7.85545 14.7938C8.12399 15.0623 8.25093 15.4432 8.18746 15.8191L7.19632 21.6634L12.3327 18.9195C12.6793 18.7339 13.0943 18.7339 13.4361 18.9195L18.5724 21.6634L17.5862 15.824C17.5227 15.4481 17.6448 15.0672 17.9182 14.7987L22.1122 10.6437L16.3363 9.7893C15.9554 9.73071 15.6234 9.49147 15.4525 9.13994L12.8844 3.85713Z" fill="#CF6D3F"/><path d="M15.6241 9.37423L13.2805 2.34351L10.1557 9.37423L3.125 10.1554L7.81215 15.6238L7.03095 21.8733L12.4993 19.5297L18.7488 21.8733L17.9676 15.6238L23.436 10.1554L15.6241 9.37423Z" fill="#CF6D3F"/></svg>');
                    }
    
                    // Vérifier si une demi-étoile est nécessaire
                    if (rating % 1 !== 0) {
                        let halfStarIndex = fullStars;
                        $(this).find('.star-wrapper:eq(' + halfStarIndex + ')').addClass('half').append('<svg width="26" height="25" viewBox="0 0 26 25" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12.8843 2.43695e-05C13.3335 2.43695e-05 13.7437 0.253913 13.939 0.659154L17.2883 7.55805L24.7682 8.66148C25.2076 8.72495 25.5738 9.03255 25.7105 9.45732C25.8472 9.88209 25.7349 10.341 25.4225 10.6535L19.9981 16.034L21.2773 23.6311C21.3505 24.0705 21.1699 24.5148 20.8037 24.7784C20.4375 25.0421 19.959 25.0714 19.5684 24.8614L12.8795 21.2875L6.20028 24.8565C5.8048 25.0665 5.32632 25.0372 4.96502 24.7735C4.60372 24.5099 4.41819 24.0656 4.49143 23.6262L5.77063 16.0291L0.34623 10.6535C0.0288713 10.341 -0.0785425 9.87721 0.058166 9.45732C0.194874 9.03743 0.561058 8.72983 1.00048 8.66148L8.48038 7.55805L11.8297 0.659154C12.0299 0.253913 12.4352 2.43695e-05 12.8843 2.43695e-05ZM12.8843 3.57397L10.9366 6.24955L10.3211 9.13996C10.1502 9.48661 9.82305 9.73074 9.43734 9.78932L3.66141 10.6389L7.85543 14.7938C8.12396 15.0624 8.25091 15.4432 8.18744 15.8191L7.1963 21.6634L7.85543 14.7938L3.66141 10.6389L8.18744 9.78932L12.8843 3.57397C13.231 3.38844 12.5377 17.8884 12.8795 18.074L18.5724 21.6634L17.5861 15.824C17.5227 15.4481 17.6447 15.0672 17.9181 14.7987L22.1122 10.6438L16.3362 9.78932C15.9554 9.73074 15.6234 9.4915 15.4525 9.13996L12.8843 3.57397Z" fill="#CF6D3F"/></svg>');
                    }
    
                    // Remplir les étoiles vides
                    let emptyStars = 5 - Math.ceil(rating);
                    for (let i = fullStars + 1; i <= fullStars + emptyStars; i++) {
                        $(this).find('.star-wrapper:eq(' + i + ')').addClass('empty').append('<svg width="26" height="25" viewBox="0 0 26 25" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12.8844 0C13.3336 0 13.7437 0.253887 13.939 0.65913L17.2883 7.55802L24.7682 8.66146C25.2077 8.72493 25.5738 9.03252 25.7105 9.45729C25.8473 9.88207 25.735 10.341 25.4225 10.6535L19.9981 16.0339L21.2773 23.631C21.3505 24.0704 21.1699 24.5148 20.8037 24.7784C20.4375 25.0421 19.959 25.0714 19.5684 24.8614L12.8795 21.2875L6.20031 24.8565C5.80483 25.0665 5.32635 25.0372 4.96505 24.7735C4.60375 24.5099 4.41821 24.0656 4.49145 23.6261L5.77065 16.0291L0.346255 10.6535C0.0288961 10.341 -0.0785177 9.87718 0.0581908 9.45729C0.194899 9.0374 0.561082 8.72981 1.0005 8.66146L8.48041 7.55802L11.8298 0.65913C12.0299 0.253887 12.4352 0 12.8844 0ZM12.8844 3.85713L10.3211 9.13994C10.1502 9.48659 9.82308 9.73071 9.43737 9.7893L3.66143 10.6388L7.85545 14.7938C8.12399 15.0623 8.25093 15.4432 8.18746 15.8191L7.19632 21.6634L12.3327 18.9195C12.6793 18.7339 13.0943 18.7339 13.4361 18.9195L18.5724 21.6634L17.5862 15.824C17.5227 15.4481 17.6448 15.0672 17.9182 14.7987L22.1122 10.6437L16.3363 9.7893C15.9554 9.73071 15.6234 9.49147 15.4525 9.13994L12.8844 3.85713Z" fill="#CF6D3F"/></svg>');
                    }
    
                    for (let i = fullStars; i < fullStars + emptyStars; i++) {
                        $(this).find('.star-wrapper:eq(' + i + ')').addClass('empty').append('<svg width="26" height="25" viewBox="0 0 26 25" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12.8844 0C13.3336 0 13.7437 0.253887 13.939 0.65913L17.2883 7.55802L24.7682 8.66146C25.2077 8.72493 25.5738 9.03252 25.7105 9.45729C25.8473 9.88207 25.735 10.341 25.4225 10.6535L19.9981 16.0339L21.2773 23.631C21.3505 24.0704 21.1699 24.5148 20.8037 24.7784C20.4375 25.0421 19.959 25.0714 19.5684 24.8614L12.8795 21.2875L6.20031 24.8565C5.80483 25.0665 5.32635 25.0372 4.96505 24.7735C4.60375 24.5099 4.41821 24.0656 4.49145 23.6261L5.77065 16.0291L0.346255 10.6535C0.0288961 10.341 -0.0785177 9.87718 0.0581908 9.45729C0.194899 9.0374 0.561082 8.72981 1.0005 8.66146L8.48041 7.55802L11.8298 0.65913C12.0299 0.253887 12.4352 0 12.8844 0ZM12.8844 3.85713L10.3211 9.13994C10.1502 9.48659 9.82308 9.73071 9.43737 9.7893L3.66143 10.6388L7.85545 14.7938C8.12399 15.0623 8.25093 15.4432 8.18746 15.8191L7.19632 21.6634L12.3327 18.9195C12.6793 18.7339 13.0943 18.7339 13.4361 18.9195L18.5724 21.6634L17.5862 15.824C17.5227 15.4481 17.6448 15.0672 17.9182 14.7987L22.1122 10.6437L16.3363 9.7893C15.9554 9.73071 15.6234 9.49147 15.4525 9.13994L12.8844 3.85713Z" fill="#CF6D3F"/></svg>');
                    }
                } else {
                    for (let i = fullStars; i < fullStars + emptyStars; i++) {
                        $(this).find('.star-wrapper').addClass('empty').append('<svg width="26" height="25" viewBox="0 0 26 25" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12.8844 0C13.3336 0 13.7437 0.253887 13.939 0.65913L17.2883 7.55802L24.7682 8.66146C25.2077 8.72493 25.5738 9.03252 25.7105 9.45729C25.8473 9.88207 25.735 10.341 25.4225 10.6535L19.9981 16.0339L21.2773 23.631C21.3505 24.0704 21.1699 24.5148 20.8037 24.7784C20.4375 25.0421 19.959 25.0714 19.5684 24.8614L12.8795 21.2875L6.20031 24.8565C5.80483 25.0665 5.32635 25.0372 4.96505 24.7735C4.60375 24.5099 4.41821 24.0656 4.49145 23.6261L5.77065 16.0291L0.346255 10.6535C0.0288961 10.341 -0.0785177 9.87718 0.0581908 9.45729C0.194899 9.0374 0.561082 8.72981 1.0005 8.66146L8.48041 7.55802L11.8298 0.65913C12.0299 0.253887 12.4352 0 12.8844 0ZM12.8844 3.85713L10.3211 9.13994C10.1502 9.48659 9.82308 9.73071 9.43737 9.7893L3.66143 10.6388L7.85545 14.7938C8.12399 15.0623 8.25093 15.4432 8.18746 15.8191L7.19632 21.6634L12.3327 18.9195C12.6793 18.7339 13.0943 18.7339 13.4361 18.9195L18.5724 21.6634L17.5862 15.824C17.5227 15.4481 17.6448 15.0672 17.9182 14.7987L22.1122 10.6437L16.3363 9.7893C15.9554 9.73071 15.6234 9.49147 15.4525 9.13994L12.8844 3.85713Z" fill="#CF6D3F"/></svg>');
                    }
                }
            })
    
            $('.post-stars-wrapper').each(function(){
                let rating = $('#post-average-rating').text();
                if(rating){
                    // Afficher les étoiles entières
                    let fullStars = Math.floor(rating);
                    for (let i = 0; i < fullStars; i++) {
                        $(this).find('.star-wrapper:eq(' + i + ')').addClass('active').append('<svg width="26" height="25" viewBox="0 0 26 25" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12.8844 0C13.3336 0 13.7437 0.253887 13.939 0.65913L17.2883 7.55802L24.7682 8.66146C25.2077 8.72493 25.5738 9.03252 25.7105 9.45729C25.8473 9.88207 25.735 10.341 25.4225 10.6535L19.9981 16.0339L21.2773 23.631C21.3505 24.0704 21.1699 24.5148 20.8037 24.7784C20.4375 25.0421 19.959 25.0714 19.5684 24.8614L12.8795 21.2875L6.20031 24.8565C5.80483 25.0665 5.32635 25.0372 4.96505 24.7735C4.60375 24.5099 4.41821 24.0656 4.49145 23.6261L5.77065 16.0291L0.346255 10.6535C0.0288961 10.341 -0.0785177 9.87718 0.0581908 9.45729C0.194899 9.0374 0.561082 8.72981 1.0005 8.66146L8.48041 7.55802L11.8298 0.65913C12.0299 0.253887 12.4352 0 12.8844 0ZM12.8844 3.85713L10.3211 9.13994C10.1502 9.48659 9.82308 9.73071 9.43737 9.7893L3.66143 10.6388L7.85545 14.7938C8.12399 15.0623 8.25093 15.4432 8.18746 15.8191L7.19632 21.6634L12.3327 18.9195C12.6793 18.7339 13.0943 18.7339 13.4361 18.9195L18.5724 21.6634L17.5862 15.824C17.5227 15.4481 17.6448 15.0672 17.9182 14.7987L22.1122 10.6437L16.3363 9.7893C15.9554 9.73071 15.6234 9.49147 15.4525 9.13994L12.8844 3.85713Z" fill="#CF6D3F"/><path d="M15.6241 9.37423L13.2805 2.34351L10.1557 9.37423L3.125 10.1554L7.81215 15.6238L7.03095 21.8733L12.4993 19.5297L18.7488 21.8733L17.9676 15.6238L23.436 10.1554L15.6241 9.37423Z" fill="#CF6D3F"/></svg>');
                    }
    
                    // Vérifier si une demi-étoile est nécessaire
                    if (rating % 1 !== 0) {
                        let halfStarIndex = fullStars;
                        $(this).find('.star-wrapper:eq(' + halfStarIndex + ')').addClass('half').append('<svg width="26" height="25" viewBox="0 0 26 25" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12.8843 2.43695e-05C13.3335 2.43695e-05 13.7437 0.253913 13.939 0.659154L17.2883 7.55805L24.7682 8.66148C25.2076 8.72495 25.5738 9.03255 25.7105 9.45732C25.8472 9.88209 25.7349 10.341 25.4225 10.6535L19.9981 16.034L21.2773 23.6311C21.3505 24.0705 21.1699 24.5148 20.8037 24.7784C20.4375 25.0421 19.959 25.0714 19.5684 24.8614L12.8795 21.2875L6.20028 24.8565C5.8048 25.0665 5.32632 25.0372 4.96502 24.7735C4.60372 24.5099 4.41819 24.0656 4.49143 23.6262L5.77063 16.0291L0.34623 10.6535C0.0288713 10.341 -0.0785425 9.87721 0.058166 9.45732C0.194874 9.03743 0.561058 8.72983 1.00048 8.66148L8.48038 7.55805L11.8297 0.659154C12.0299 0.253913 12.4352 2.43695e-05 12.8843 2.43695e-05ZM12.8843 3.57397L10.9366 6.24955L10.3211 9.13996C10.1502 9.48661 9.82305 9.73074 9.43734 9.78932L3.66141 10.6389L7.85543 14.7938C8.12396 15.0624 8.25091 15.4432 8.18744 15.8191L7.1963 21.6634L7.85543 14.7938L3.66141 10.6389L8.18744 9.78932L12.8843 3.57397C13.231 3.38844 12.5377 17.8884 12.8795 18.074L18.5724 21.6634L17.5861 15.824C17.5227 15.4481 17.6447 15.0672 17.9181 14.7987L22.1122 10.6438L16.3362 9.78932C15.9554 9.73074 15.6234 9.4915 15.4525 9.13996L12.8843 3.57397Z" fill="#CF6D3F"/></svg>');
                    }
    
                    // Remplir les étoiles vides
                    let emptyStars = 5 - Math.ceil(rating);
                    // for (let i = fullStars + 1; i <= fullStars + emptyStars; i++) {
                    //     $(this).find('.star-wrapper:eq(' + i + ')').addClass('empty').append('<svg width="26" height="25" viewBox="0 0 26 25" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12.8844 0C13.3336 0 13.7437 0.253887 13.939 0.65913L17.2883 7.55802L24.7682 8.66146C25.2077 8.72493 25.5738 9.03252 25.7105 9.45729C25.8473 9.88207 25.735 10.341 25.4225 10.6535L19.9981 16.0339L21.2773 23.631C21.3505 24.0704 21.1699 24.5148 20.8037 24.7784C20.4375 25.0421 19.959 25.0714 19.5684 24.8614L12.8795 21.2875L6.20031 24.8565C5.80483 25.0665 5.32635 25.0372 4.96505 24.7735C4.60375 24.5099 4.41821 24.0656 4.49145 23.6261L5.77065 16.0291L0.346255 10.6535C0.0288961 10.341 -0.0785177 9.87718 0.0581908 9.45729C0.194899 9.0374 0.561082 8.72981 1.0005 8.66146L8.48041 7.55802L11.8298 0.65913C12.0299 0.253887 12.4352 0 12.8844 0ZM12.8844 3.85713L10.3211 9.13994C10.1502 9.48659 9.82308 9.73071 9.43737 9.7893L3.66143 10.6388L7.85545 14.7938C8.12399 15.0623 8.25093 15.4432 8.18746 15.8191L7.19632 21.6634L12.3327 18.9195C12.6793 18.7339 13.0943 18.7339 13.4361 18.9195L18.5724 21.6634L17.5862 15.824C17.5227 15.4481 17.6448 15.0672 17.9182 14.7987L22.1122 10.6437L16.3363 9.7893C15.9554 9.73071 15.6234 9.49147 15.4525 9.13994L12.8844 3.85713Z" fill="#CF6D3F"/></svg>');
                    // }
    
                    for (let i = fullStars; i < fullStars + emptyStars; i++) {
                        $(this).find('.star-wrapper:eq(' + i + ')').addClass('empty').append('<svg width="26" height="25" viewBox="0 0 26 25" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12.8844 0C13.3336 0 13.7437 0.253887 13.939 0.65913L17.2883 7.55802L24.7682 8.66146C25.2077 8.72493 25.5738 9.03252 25.7105 9.45729C25.8473 9.88207 25.735 10.341 25.4225 10.6535L19.9981 16.0339L21.2773 23.631C21.3505 24.0704 21.1699 24.5148 20.8037 24.7784C20.4375 25.0421 19.959 25.0714 19.5684 24.8614L12.8795 21.2875L6.20031 24.8565C5.80483 25.0665 5.32635 25.0372 4.96505 24.7735C4.60375 24.5099 4.41821 24.0656 4.49145 23.6261L5.77065 16.0291L0.346255 10.6535C0.0288961 10.341 -0.0785177 9.87718 0.0581908 9.45729C0.194899 9.0374 0.561082 8.72981 1.0005 8.66146L8.48041 7.55802L11.8298 0.65913C12.0299 0.253887 12.4352 0 12.8844 0ZM12.8844 3.85713L10.3211 9.13994C10.1502 9.48659 9.82308 9.73071 9.43737 9.7893L3.66143 10.6388L7.85545 14.7938C8.12399 15.0623 8.25093 15.4432 8.18746 15.8191L7.19632 21.6634L12.3327 18.9195C12.6793 18.7339 13.0943 18.7339 13.4361 18.9195L18.5724 21.6634L17.5862 15.824C17.5227 15.4481 17.6448 15.0672 17.9182 14.7987L22.1122 10.6437L16.3363 9.7893C15.9554 9.73071 15.6234 9.49147 15.4525 9.13994L12.8844 3.85713Z" fill="#CF6D3F"/></svg>');
                    }
                } else {
                    $(this).find('.star-wrapper').addClass('empty').append('<svg width="26" height="25" viewBox="0 0 26 25" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12.8844 0C13.3336 0 13.7437 0.253887 13.939 0.65913L17.2883 7.55802L24.7682 8.66146C25.2077 8.72493 25.5738 9.03252 25.7105 9.45729C25.8473 9.88207 25.735 10.341 25.4225 10.6535L19.9981 16.0339L21.2773 23.631C21.3505 24.0704 21.1699 24.5148 20.8037 24.7784C20.4375 25.0421 19.959 25.0714 19.5684 24.8614L12.8795 21.2875L6.20031 24.8565C5.80483 25.0665 5.32635 25.0372 4.96505 24.7735C4.60375 24.5099 4.41821 24.0656 4.49145 23.6261L5.77065 16.0291L0.346255 10.6535C0.0288961 10.341 -0.0785177 9.87718 0.0581908 9.45729C0.194899 9.0374 0.561082 8.72981 1.0005 8.66146L8.48041 7.55802L11.8298 0.65913C12.0299 0.253887 12.4352 0 12.8844 0ZM12.8844 3.85713L10.3211 9.13994C10.1502 9.48659 9.82308 9.73071 9.43737 9.7893L3.66143 10.6388L7.85545 14.7938C8.12399 15.0623 8.25093 15.4432 8.18746 15.8191L7.19632 21.6634L12.3327 18.9195C12.6793 18.7339 13.0943 18.7339 13.4361 18.9195L18.5724 21.6634L17.5862 15.824C17.5227 15.4481 17.6448 15.0672 17.9182 14.7987L22.1122 10.6437L16.3363 9.7893C15.9554 9.73071 15.6234 9.49147 15.4525 9.13994L12.8844 3.85713Z" fill="#CF6D3F"/></svg>');
                }
            })
        }
        fillStar();

        $(document).ajaxComplete(function(event, xhr, settings) {
            // fillStar();
        })

        $('.popup-global-ginette-review-container .glsr-button').on('click', function(){

            // assign user display name as post title for backend 

            setTimeout(function(){
                if($('.glsr-form-message').hasClass('glsr-form-success')){
                    location.reload(true);
                }
            }, 5000)
        })


    })
})(jQuery);